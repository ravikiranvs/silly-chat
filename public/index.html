<!doctype html>
<html>
  <head>
    <title>silly-chat</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
      
      #name{ display: none; position: absolute;left: 50%;top: 50%; margin-left: -170px; margin-top: -50px; }
      #name input { 
        padding: 5px;
        border: 0;
        border-bottom: 1px solid;
        outline: 0;
      }
      
      #header{
        display: none;
        background: #26C2F0;
        color: white;
        position: fixed; 
        top: 0; 
        width: 100%; 
        z-index: 100;
        padding: 10px;
        font-size: 18px;
      }
      #users {
        display: inline-block;
        list-style-type: none;
      }
      #users li { display: inline; list-style-type: none; padding: 20px; }
      
      #messages { list-style-type: none; padding: 0; width: 100%; float: right; margin-bottom: 40px; position:absolute; bottom: 10px; }
      
      form { position: fixed; bottom: 0; width: 100%; }
      form input {
        padding: 10px;
        width: 90%;
        border: 0;
        border-top: 1px solid #26C2F0;
        outline: 0;
        font-size: large;
       }
      form button { 
        width: 10%;
        background: #26C2F0;
        color: #ffffff;
        border: none;
        padding: 16px;
       }
       
       #settings{
         color: #ffffff;
         position: absolute;
         height: 100%;
         width: 300px;
         z-index: 1000;
         background-color: #36D2F0;
         left: -300px;
         
          -webkit-transition: left, 0.1s linear;
          -moz-transition: left, 0.1s linear;
          -ms-transition: left, 0.1s linear;
          -o-transition: left, 0.1s linear;
          transition: left, 0.1s linear;
       }
       .showSideNav{
        left: 0px !important;
        -webkit-transition: left, 0.1s linear;
        -moz-transition: left, 0.1s linear;
        -ms-transition: left, 0.1s linear;
        -o-transition: left, 0.1s linear;
        transition: left, 0.1s linear;
       }
    </style>
    <link rel="stylesheet" type="text/css" href="css/main.css"></link>
    <link rel="icon" type="image/png" href="images/silly_chat_16.png">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/emojione/1.5.0/assets/css/emojione.min.css" />
  </head>
  <body>
    <div id="settings">
      <div class="header">
        <a class="fa fa-times" onclick="toggleSideMenu()"></a>
      </div>
      <div style="padding: 10px">
        Name<input id="settingsName"></input>
      </div>
      <div style="padding: 10px; display: inline-flex;">
        Notification
        <div class="notificationSetting">
          <input type="checkbox" value="None" id="settingsNotification" name="check" />
          <label for="settingsNotification"></label>
        </div>
      </div>
      <div style="padding: 10px">
        <button id="settingsSave" onclick="saveSettings()">OK</button>
      </div>
    </div>
    
    <div id="header">
      <a class="fa fa-cog" onclick="toggleSideMenu()"></a>
      <ul id="users"></ul>
      <a class="fa fa-compress" style="float: right" onclick="newSmallWindow()"></a>
    </div>
    
    <ul id="messages"></ul>
    
    <div id="emojiPredict"></div>
    
    <form id="sendM" action="" onsubmit="return sendMessage()" style="display: none">
      <input id="m" autocomplete="off" onkeyup="emojiReplace(this)" /><button class="fa fa-paper-plane"></button>
    </form>
    
    <div id="name">
      <input id="txtName" placeholder="Name" onkeyup="txtNameKeyUp(event);" />
    </div>
    
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io();
      
      var configStrs = document.cookie ? document.cookie.split("##") : ["", "true"]; 
      var config = {
        name: configStrs[0],
        notification: configStrs[1]
      };
      
      var DomElements = {
        UserNameBox: {
          div: document.getElementById('name'),
          input: document.getElementById('txtName')
        },
        Messages: {
          ul: document.getElementById('messages')
        },
        MsgBox: {
          form: document.getElementById('sendM'),
          input: document.getElementById('m')
        },
        Header: {
          div: document.getElementById('header'),
          ul: document.getElementById('users')
        },
        Settings: {
          div: document.getElementById('settings'),
          name: document.getElementById('settingsName'),
          notification: document.getElementById('settingsNotification'),
          button: document.getElementById('settingsSave')
        }
      }
      
      
      function txtNameKeyUp(event){
        if(event.keyCode == 13){
          userName = DomElements.UserNameBox.input.value;
          setUserName(userName);
          MessagingUnScreenToggle(false);
        }
      }

      
      function setUserName(name){
        if(name){
          socket.emit('users', name);
          config.name = name;
          document.cookie = name + "##" + config.notification;
        }
      }
      
      
      
      var userName = config.name;
      if(userName) setUserName(userName);
      MessagingUnScreenToggle(!userName);
      
      
      
      function MessagingUnScreenToggle(unDisp){
        if(unDisp){
          UnDisplayValue = 'block';
          MessageDisplayValue = 'none';
          
          DomElements.UserNameBox.input.focus();
        }
        else{
          UnDisplayValue = 'none';
          MessageDisplayValue = 'block';
          
          DomElements.MsgBox.input.focus();
        }
        
        DomElements.UserNameBox.div.style.display = UnDisplayValue;
        DomElements.Messages.ul.style.display = MessageDisplayValue;
        DomElements.MsgBox.form.style.display = MessageDisplayValue;
        DomElements.Header.div.style.display = MessageDisplayValue;
      }
      
      var ulMessages = document.getElementById('messages');
    </script>
    <script src="scripts/app.js"></script>
    <script src="//cdn.jsdelivr.net/emojione/1.5.0/lib/js/emojione.min.js"></script>
  </body>
</html>